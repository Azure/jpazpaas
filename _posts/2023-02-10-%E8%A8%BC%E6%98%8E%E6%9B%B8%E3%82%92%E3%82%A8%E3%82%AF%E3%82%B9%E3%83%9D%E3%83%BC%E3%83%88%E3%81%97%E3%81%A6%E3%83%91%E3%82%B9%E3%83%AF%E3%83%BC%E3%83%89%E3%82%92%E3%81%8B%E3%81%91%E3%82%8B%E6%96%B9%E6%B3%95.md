# 証明書をエクスポートしてパスワードをかける方法
App Service 証明書をエクスポートしてApplication Gateway にアップロードしたいとします。しかし証明書にはパスワードが設定されておらず、そのままでは Application Gateway にインポートできないため、パスワードを設定する必要性があります。
そういったケースに対応するため、今回はApp Service 証明書をエクスポートしてパスワードを設定する方法をご紹介します。手順は以下の３つです。<br>
手順１）App Service 証明書をエクスポートする<br>
手順２） エクスポートした証明書をローカル環境にインポートする (ローカルの Windows 環境にて)<br>
手順３） ローカル環境でパスワードを設定する。<br>
***
手順１）App Service 証明書をエクスポートする。<br>
1-1. App Service 証明書のページより、[証明書のエクスポート] を選択し、Key Vault シークレットを開きます。<br>
![1-1-6668bbe3-b039-45a1-ac00-fec8d21486e0.gif]({{site.baseurl}}/media/2023/02/1-1-6668bbe3-b039-45a1-ac00-fec8d21486e0.gif)<br>

1-2. エクスポート対象として、現在のバージョンを選択します。<br>
![1-2-f50f0c39-291d-434b-a70d-993fbfca0392.gif]({{site.baseurl}}/media/2023/02/1-2-f50f0c39-291d-434b-a70d-993fbfca0392.gif)<br>

1-3. 下部の [証明書としてダウンロード] を選択します。<br>
![1-3-7529019f-9c0b-43de-ad8c-fe5556c332ee.gif]({{site.baseurl}}/media/2023/02/1-3-7529019f-9c0b-43de-ad8c-fe5556c332ee.gif)<br/>

手順２） エクスポートした証明書をローカル環境にインポートする<br>
2-1. 証明書を右クリックし、 [PFX のインストール(I)] をクリックします。<br>
![2-1-77705061-5e84-48bd-9249-fbfd59474de6.gif]({{site.baseurl}}/media/2023/02/2-1-77705061-5e84-48bd-9249-fbfd59474de6.gif)<br>

2-2. [証明書のインポート ウィザード] が開始されますので、順を追って進みます。保存場所は [現在のユーザー(C)] を指定します。
![2-2-b2f1cfba-f240-4a1b-b064-a41a86d7c2a1.gif]({{site.baseurl}}/media/2023/02/2-2-b2f1cfba-f240-4a1b-b064-a41a86d7c2a1.gif)<br>

2-3. インポートする証明書ファイルは 1-3 でエクスポートした証明書を指定します。<br>
![2-3-455d6592-d39e-46c5-9590-cd30b2df59ae.gif]({{site.baseurl}}/media/2023/02/2-3-455d6592-d39e-46c5-9590-cd30b2df59ae.gif) <br>

2-4. インポートオプションで、 [このキーをエクスポート可能にする(M)] にチェックを入れます。<br>
![2-4-5331fe4e-7836-4db5-9e46-96fb5e7c843b.gif]({{site.baseurl}}/media/2023/02/2-4-5331fe4e-7836-4db5-9e46-96fb5e7c843b.gif)<br>

2-5. [証明書の種類に基づいて、自動的に証明書ストアを選択する (U)] を選択します。<br>
![2-5-e0c46e5d-6255-489c-a1b1-32ca7e895fcd.gif]({{site.baseurl}}/media/2023/02/2-5-e0c46e5d-6255-489c-a1b1-32ca7e895fcd.gif)<br>

2-6. インポートの確認が表示されますので、[完了] をクリックします。以上でインポートは完了です。<br>
![2-6-cdad02c5-d0a3-4473-a3ae-abe98835d830.gif]({{site.baseurl}}/media/2023/02/2-6-cdad02c5-d0a3-4473-a3ae-abe98835d830.gif)<br>

手順３） ローカル環境でパスワードを設定する。<br>
先ほどインポートした証明書にパスワードを設定して保存 (エクスポート) します。<br>
3-1. [ユーザー証明書の管理] を実行します。スタートメニューより cert で検索しますと、表示されます。<br>
![3-1-4bcfa759-54a0-4bf4-a978-7f41f91d5599.gif]({{site.baseurl}}/media/2023/02/3-1-4bcfa759-54a0-4bf4-a978-7f41f91d5599.gif)<br>

3-2. ローカルの Windows に格納されている証明書の一覧が表示されます。先ほどインポートした証明書は、左側のツリーの [個人 > 証明書] に格納されています。<br>
![3-2-13f09546-e483-43e1-a753-7378212ff27b.gif]({{site.baseurl}}/media/2023/02/3-2-13f09546-e483-43e1-a753-7378212ff27b.gif)<br>

3-3. 対象の証明書を右クリックして、 [すべてのタスク(K)] > [エクスポート(E)] をクリックします。<br>
3-4. 証明書のエクスポート ウィザードが開始されます。<br>
![3-4-a41ec8e4-ba88-4b84-b997-687a1b591cb1.gif]({{site.baseurl}}/media/2023/02/3-4-a41ec8e4-ba88-4b84-b997-687a1b591cb1.gif)<br>

3-5. [はい、秘密鍵をエクスポートします(Y)] を選択します。<br>
![3-5-1eaf074c-aaa6-4e7f-91af-d2eed1bf8262.gif]({{site.baseurl}}/media/2023/02/3-5-1eaf074c-aaa6-4e7f-91af-d2eed1bf8262.gif)<br>
3-6. エクスポートするファイル形式として、[Personal Information Exchange - PKCS#12] を選択しま
す。<br>
![3-6-c42d64d9-ed23-477e-8aee-833662fdc96b.gif]({{site.baseurl}}/media/2023/02/3-6-c42d64d9-ed23-477e-8aee-833662fdc96b.gif)<br>

3-7. パスワードを設定します。任意の文字列で問題ございませんが、ある程度長い文字列で推測が難しいものをお勧めします。<br>
![3-7-1e8a4507-8986-44ae-954e-34eb14dda066.gif]({{site.baseurl}}/media/2023/02/3-7-1e8a4507-8986-44ae-954e-34eb14dda066.gif)<br>

3-8. パスワードを付けて、エクスポートした証明書を保存先を指定します。<br>
![3-8-0fa78f15-24e6-49ca-add0-0a7dd2fbcb7e.gif]({{site.baseurl}}/media/2023/02/3-8-0fa78f15-24e6-49ca-add0-0a7dd2fbcb7e.gif)<br>

3-9. エクスポートの確認が表示されますので、[完了] をクリックします。<br>
![3-9-1b11a24a-db20-483e-b692-3391f162c7f9.gif]({{site.baseurl}}/media/2023/02/3-9-1b11a24a-db20-483e-b692-3391f162c7f9.gif)<br>

これでパスワード付きの証明書ができたので、対象のアプリケーションにアップロードできます。